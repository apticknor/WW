<div class="pageWrapper">
    <div class="pageWrapper-section pageWrapper-section_isCentered">
        <h1 class="sectionTitle"><a href="{{ blog.url }}">{{ blog.title }}</a></h1>
    </div>
    <div class="pageWrapper-section pageWrapper-section_isTight">

        {% paginate article.comments by 100 %}

            {% assign number_of_comments = article.comments_count %}

            {% if comment and comment.created_at %}
                {% assign number_of_comments = article.comments_count | plus: 1 %}
            {% endif %}

            <h2>{{ article.title }}</h2>
            <time pubdate datetime="{{ article.published_at | date: '%Y-%m-%d' }}">
                {{ article.published_at | date: '%b %d, %Y' }}
            </time>

            <div>
                {{ article.content }}
            </div>

            {% if blog.comments_enabled? and article.comments_count > 0 %}
                <a href="#comments">
                    {{ article.comments_count }} {{ article.comments_count | pluralize: 'comment','comments' }}
                </a>
            {% endif %}

            {% if article.tags.size > 0 %}
                {% for tag in article.tags %}
                    <a href="{{ blog.url }}/tagged/{{ tag | handle }}">
                        {{ tag }}
                    </a>
                    {% unless forloop.last %}, {% endunless %}
                {% endfor %}
            {% endif %}

            {% if blog.comments_enabled? %}

                {% if comment and comment.created_at %}
                    <div>
                        {% if blog.moderated? %}
                            Your comment was posted successfully. We will publish it in a little while, as our blog is moderated.
                        {% else %}
                            Your comment was posted successfully! Thank you!
                        {% endif %}
                    </div>
                {% endif %}

                {% if number_of_comments > 0 %}
                <ul>

                    {% if comment and comment.created_at %}
                    <li id="{{ comment.id }}">
                        <h3>{{ comment.author }} says...</h3>
                        <div>
                            {{ comment.content }}
                        </div>
                        <div>
                            On {{ comment.created_at | date: "%B %d, %Y" }}
                        </div>
                    </li>
                    {% endif %}

                    {% for comment in article.comments %}
                    <li id="{{ comment.id }}">
                        <h3>{{ comment.author }} says...</h3>
                        <div>
                            {{ comment.content }}
                        </div>
                        <div>
                            On {{ comment.created_at | date: "%B %d, %Y" }}
                        </div>
                    </li>
                    {% endfor %}

                </ul>
                {% endif %}

                {% if paginate.pages > 1 %}
                    {{ paginate | default_pagination }}
                {% endif %}

                {% form "new_comment", article %}

                    <h3>Leave a comment</h3>

                    {% if form.errors %}
                        <div>
                            {{ form.errors | default_errors }}
                        </div>
                    {% endif %}

                    <label for="comment-author">Name</label>
                    <input required{% if form.errors contains "author" %} class="error"{% endif %} type="text" name="comment[author]" placeholder="Your name" id="comment-author" value="{{ form.author }}" />

                    <label for="comment-email">Email</label>
                    <input required{% if form.errors contains "email" %} class="error"{% endif %} type="email" name="comment[email]" placeholder="your@email.com" id="comment-email" value="{{ form.email }}" />

                    <label for="comment-body">Message</label>
                    <textarea required{% if form.errors contains "body" %} class="error"{% endif %} name="comment[body]" id="comment-body">{{ form.body }}</textarea>

                    <input type="submit" value="Post Comment" />

                {% endform %}

            {% endif %}

            {% if blog.next_article or blog.previous_article %}
                {% if blog.next_article %}
                    {{ '&larr; Next Post' | link_to: blog.next_article }}
                {% endif %}
                {% if blog.previous_article %}
                    {{ 'Previous Post &rarr;' | link_to: blog.previous_article }}
                {% endif %}
            {% endif %}
        {% endpaginate %}
    </div>
</div>
